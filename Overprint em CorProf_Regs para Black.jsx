//Overprint em CorProf.jsx//Renato Akira/*  @@@BUILDINFO@@@ "ImageCatalog.jsx" 1.0.0 23 agosto 2016//Script programado para://1 - Aplicar overprint em objetos e caracteres que utilizam as swatches: CorProf, Resposta, Professor (sem distinção de caixa alta ou baixa ou espaços)//2 - Substituir todos os casos de Registration para Black (100%)//3 - //*/ main();function main() {    var curDoc = app.activeDocument;  var allSwatches = curDoc.swatches;  var allPItems = curDoc.allPageItems;  var colorsToOverprint = [];  //index, array com todas as cores que receberão o overprintvar myTexts=curDoc.stories.everyItem().getElements(); //lcaixas com cor de texto uniforme//var myTexts=curDoc.stories.everyItem().texts.everyItem().characters.everyItem().getElements(); //letrasvar Log = [];var black = curDoc.swatches.item("Black"); var RegAppFill = "";var RegAppStroke = "";var RegAppText = "";var fF = 0;var fS = 0;var fT = 0;for (var i = 0; i < allSwatches.length; i++) {    var curSwatch = allSwatches[i];  //Current swatch = All Swatches [index]  var curSwatchName = curSwatch.name; //Variavel com propriedade .name da current swatch no index  var colorToFind = curSwatchName.search(/Cor[-_ ]?Prof|Resposta|Professor/i);  //comando .search com GREP para retornar swatch  if (colorToFind != -1)       {      colorsToOverprint.push(curSwatch.name);      }    } //end for para procurar as swatches  for (i = 0; i < allPItems.length; i++) //Selecionando os itens para analise de cor  {        var curItem = allPItems[i];    try  {    var fColorName = curItem.fillColor.name;    var sColorName = curItem.strokeColor.name;         if (fColorName == "Registration") {curItem.fillColor = black;  fF= fF+1; RegAppFill = "\r• Registration em preenchimento encontrada e substituída por black em "+fF+" objetos"}         if (sColorName == "Registration") {curItem.strokeColor = black; fS=fS+1;RegAppStroke =  "\r• Registration em contorno encontrada e substituída por black em "+fS+" objetos"}    for (var j = 0; j < colorsToOverprint.length; j++) //Aplicando overprint em itens com as cores listadas no colorsToOverprint        {              var curColorName = colorsToOverprint[j];                            if (fColorName == curColorName) {curItem.overprintFill = true;}                if (sColorName == curColorName) {curItem.overprintStroke = true;}        } //final do FOR para aplicar a overprint      }//final do try, se der erro, ignorar com o catch    catch(e){};   } //final do FOR para selecionar os objetos do arquivofor(k = 0; k < myTexts.length; k++) //Selecionando e aplicando overprint em caracteres    {        var myText =myTexts[k];        var tColor = myText.fillColor.name;        if (tColor == "Registration"){myText.fillColor = black; RegAppText = "\r• Registration em texto encontrada e substituída por black"}                for (var l = 0; l < colorsToOverprint.length; l++)        {var curColor = colorsToOverprint[l];               if (tColor == curColor){myText.overprintFill = true}            }        }alert("Overprint aplicado nas cores:\r" + colorsToOverprint.join("\r") + Log.join("\r")+"\r\r"+RegAppFill+RegAppStroke+RegAppText); //caixa de diálogo}